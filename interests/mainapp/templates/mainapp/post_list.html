{% extends 'mainapp/base.html' %}
{% load staticfiles %}
{% block content %}

<form class="search-form" action="{% url 'mainapp:search_results' %}" method="GET" value="{{request.GET.q}}">
    <input class="search-box" name="q" value="{{request.GET.q}}" type="text" placeholder="Search">
</form>

<!-- {% for tag in tags %}
<div class="tag-list">
    <li><a href="{% url 'mainapp:tagged' tag.slug %}">{{ tag.name }}</a></li>
{% empty %}
    <li>No tags</li>
</div>
{% endfor %} -->

{% for user in users %}
<h3>{{ user.username }}</h3>
{% endfor %}

<div class="centercontent">
    {% for post in post_list %}
    <div class="post">
        
        <p>Posted by <a href="{% url 'mainapp:user-posts' post.author.username %}"><strong>{{ post.author }}</strong></a>{% if post.author.is_superuser %} <img draggable="false" title="Verified User" class="verifed" src="{% static 'images\verified.png' %}" alt="verified" width="15" height="15" srcset=""> {% endif %} {{ post.published_date|timesince }} ago</p>
        <br><hr id="divider_post"><br>
        <h1><a title="View {{ post.title }}" class="title" href="{% url 'mainapp:post_detail' pk=post.pk %}">{{ post.title }}</a></h1>&nbsp;{% if post.NSFW %} <div class="nsfw"><p>NSFW</p></div> 
        <br>
        <p><a id="readmore" href="{% url 'mainapp:post_detail' pk=post.pk %}">Read this NSFW Post&nbsp;<i class="fas fa-angle-right"></i></a></p>
        {% elif post.spoiler %}<div class="spoiler"><p>Spoiler</p></div> 
        <br>
        <p><a id="readmore" href="{% url 'mainapp:post_detail' pk=post.pk %}">Read this post which contains a spoiler&nbsp;<i class="fas fa-angle-right"></i></a></p>
        {% elif post.spoiler and post.NSFW %}<div class="nsfw"><p>NSFW</p></div> <div class="spoiler"><p>Spoiler</p></div> 
        <br>
        <p><a id="readmore" href="{% url 'mainapp:post_detail' pk=post.pk %}">Woah! This post is a double wammy of NSFW and has a spoiler! Proceed with care!&nbsp;<i class="fas fa-angle-right"></i></a></p>
        {% else %}
        {{ post.text|safe|linebreaksbr|truncatechars_html:50 }}
        <p><a id="readmore" href="{% url 'mainapp:post_detail' pk=post.pk %}">Read More&nbsp;<i class="fas fa-angle-right"></i></a></p>
        {% endif %}
        <br>
        <div class="tags-list-detail">
            {% for tag in post.tags.all %}
            <li class="tag-list-box"><a class="tag-list-style" href="{% url 'mainapp:tagged' tag.slug %}">{{ tag.name|safe|linebreaksbr }}</a></li>&nbsp;&nbsp;
            {% empty %}
            <li>No tags</li>
            {% endfor %}
            </div>
        <br>
       
        
    <br>
    <a class="comment" title="View all {{ post.approve_comments.count }} comments" href="{% url 'mainapp:post_detail' pk=post.pk %}">Comments: {{ post.approve_comments.count }}</a>
</div>
</div><br>

{% endfor %}
{% endblock %}
<!--The way this code works is-->